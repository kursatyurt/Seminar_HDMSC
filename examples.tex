
\section{Examples}\label{sec:example}

In this section using SG\textsuperscript{++} software package~\cite{pflueger10spatially},
interpolation operation on sparse grids are tested for selection functions namely
Franke's function and Genz test functions.

\subsection{Franke's Function}\label{subsec:frankeexample}

Franke's function is a well known test function for interpolation.
It has two Gaussian peaks of different heights, and a smaller dip.
The function is illustrated in \cref{fig:fullfranke}.

The operation is started with a level 3 regular sparse grid which can be seen
in \cref{fig:regularlevel3} which has 49 grid points initially. The refinement
has been done before having approximately 400 grid points, which roughly
takes 10 refinement step when every step only one grid point is selected
for refinement. The final refined grid is shown in \cref{fig:frankegrid}.

\begin{figure}[hbtp]
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{franke.pdf}
        \caption{Regular grid.}
        \label{fig:fullfranke}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{SurfacePlot.pdf}
        \caption{The refined grid.}
        \label{fig:interpolatedfranke}
    \end{subfigure}
    \caption{Spatial refinement of a regular level 3 grid. Refinement point is marked with red.}
    \label{fig:frankesurfaceplots}
\end{figure}

\begin{figure}[hbtp]
    \centering
    \includegraphics[width=0.4\textwidth]{figures/grid_final.pdf}
    \caption{The final sparse grid with 400 grid points.}
    \label{fig:frankegrid}
\end{figure}

\begin{figure}[hbtp]
    \centering
    \input{figures/err_franke.pgf}
    \caption{Error reduction plot of Franke's function w.r.t.\ refinement steps.}
    \label{fig:frankeerr}
\end{figure}

\subsection{Genz Test Functions}\label{sec:genzfunc}

A set of test functions are taken from~\cite{Genz1987}.

\begin{equation}
    f_{disc}(x) = \left\{
    \begin{array}{ll}
        0                                             & \text{for} x \ge 0.2 , \\
        \exp\left(- \sum_{i=1}^{d} i \cdot x_i\right) & \text{otherwise}       \\
    \end{array}
    \right.
\end{equation}

\begin{equation}
    f_{prod}(x) = \frac{10^{-d}}{\prod_{i=1}^d (10i)^{-2} + \left( x_i -0.99\right)^2}
\end{equation}

\subsubsection{Discontinuous Function}\label{sec:discontinuous}

\begin{figure}[hbtp]
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{disco.pdf}
        \caption{Regular grid.}
        \label{fig:regularlevel3}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{disco.pdf}
        \caption{The refined grid.}
    \end{subfigure}
    \caption{Spatial refinement of a regular level 3 grid. Refinement point is marked with red.}
    \label{fig:peaksurface}
\end{figure}

\begin{figure}[hbtp]
    \centering
    \input{figures/err_disco.pgf}
    \caption{}
    \label{fig:discoerr}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.45\textwidth]{grid_final_disco.pdf}
    \caption{}
    \label{fig:discogrid}
\end{figure}

\subsubsection{Product Peak Function}\label{sec:productpeak}

\begin{figure}[hbtp]
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{peak_surface.pdf}
        \caption{Regular grid.}
        \label{fig:regularlevel3}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{SurfacePlot_peak.pdf}
        \caption{The refined grid.}
    \end{subfigure}
    \caption{Spatial refinement of a regular level 3 grid. Refinement point is marked with red.}
    \label{fig:peaksurface}
\end{figure}

\begin{figure}[hbtp]
    \centering
    \input{figures/err_peak.pgf}
    \caption{}
    \label{fig:peakerr}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.45\textwidth]{grid_final_peak.pdf}
    \caption{}
    \label{fig:peakgrid}
\end{figure}